(((((name of operating system as string) starts with "Win") AND (exists (values "ProductName" of keys ("HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion") of registries as string) whose ((exists match (case insensitive regex ("^[a-za-z0-9\(\)\s]*[ww][ii][nn][dd][oo][ww][ss] [xx][pp][a-za-z0-9\(\)\s]*$")) of (it as string as lowercase)))) AND (exists (values "PROCESSOR_ARCHITECTURE" of keys ("HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Environment") of registries as string) whose ((it as string as lowercase = ("x86")))) AND (exists (values "CSDVersion" of keys ("HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion") of registries as string) whose ((it as string as lowercase = ("service pack 3"))))) AND (exists (files "imagehlp.dll" of folders ((concatenation of ((it as string) of (values "SystemRoot" of keys ("HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion") of registries as string))) & "\System32")) whose ((version of it < (version "5.1.2600.6479"))))) OR (((((name of operating system as string) starts with "Win") AND (exists (values "ProductName" of keys ("HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion") of registries as string) whose ((exists match (case insensitive regex ("^[a-za-z0-9\(\)\s]*[ww][ii][nn][dd][oo][ww][ss] [xx][pp][a-za-z0-9\(\)\s]*$")) of (it as string as lowercase)))) AND (exists (values "PROCESSOR_ARCHITECTURE" of keys ("HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Environment") of registries as string) whose ((exists match (case insensitive regex ("^[aa][mm][dd]64$")) of (it as string as lowercase)))) AND (exists (values "CSDVersion" of keys ("HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion") of registries as string) whose ((it as string as lowercase = ("service pack 2"))))) OR (((name of operating system as string) starts with "Win") AND (exists (values "ProductName" of keys ("HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion") of registries as string) whose ((exists match (case insensitive regex ("^[a-za-z0-9\(\)\s]*2003[a-za-z0-9\(\)\s]*$")) of (it as string as lowercase)))) AND (exists (values "PROCESSOR_ARCHITECTURE" of keys ("HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Environment") of registries as string) whose ((it as string as lowercase = ("x86")))) AND (exists (values "CSDVersion" of keys ("HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion") of registries as string) whose ((it as string as lowercase = ("service pack 2"))))) OR (((name of operating system as string) starts with "Win") AND (exists (values "ProductName" of keys ("HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion") of registries as string) whose ((exists match (case insensitive regex ("^[a-za-z0-9\(\)\s]*2003[a-za-z0-9\(\)\s]*$")) of (it as string as lowercase)))) AND (exists (values "PROCESSOR_ARCHITECTURE" of keys ("HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Environment") of registries as string) whose ((exists match (case insensitive regex ("^[aa][mm][dd]64$")) of (it as string as lowercase)))) AND (exists (values "CSDVersion" of keys ("HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion") of registries as string) whose ((it as string as lowercase = ("service pack 2"))))) OR (((name of operating system as string) starts with "Win") AND (exists (values "ProductName" of keys ("HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion") of registries as string) whose ((exists match (case insensitive regex ("^[a-za-z0-9\(\)\s]*2003[a-za-z0-9\(\)\s]*$")) of (it as string as lowercase)))) AND (exists (values "PROCESSOR_ARCHITECTURE" of keys ("HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Environment") of registries as string) whose ((it as string as lowercase = ("ia64")))) AND (exists (values "CSDVersion" of keys ("HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion") of registries as string) whose ((it as string as lowercase = ("service pack 2")))))) AND (exists (files "imagehlp.dll" of folders ((concatenation of ((it as string) of (values "SystemRoot" of keys ("HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion") of registries as string))) & "\System32")) whose ((version of it < (version "5.2.3790.5240"))))) OR (((((name of operating system as string) starts with "Win") AND (exists (values "ProductName" of keys ("HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion") of registries as string) whose ((exists match (case insensitive regex ("^[a-za-z0-9\(\)\s]*[vv][ii][ss][tt][aa][a-za-z0-9\(\)\s]*$")) of (it as string as lowercase)))) AND (exists (values "PROCESSOR_ARCHITECTURE" of keys ("HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Environment") of registries as string) whose ((it as string as lowercase = ("x86")))) AND (exists (values "CSDVersion" of keys ("HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion") of registries as string) whose ((it as string as lowercase = ("service pack 2"))))) OR (((name of operating system as string) starts with "Win") AND (exists (values "ProductName" of keys ("HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion") of registries as string) whose ((exists match (case insensitive regex ("^[a-za-z0-9\(\)\s]*[vv][ii][ss][tt][aa][a-za-z0-9\(\)\s]*$")) of (it as string as lowercase)))) AND (exists (values "PROCESSOR_ARCHITECTURE" of keys ("HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Environment") of registries as string) whose ((exists match (case insensitive regex ("^[aa][mm][dd]64$")) of (it as string as lowercase)))) AND (exists (values "CSDVersion" of keys ("HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion") of registries as string) whose ((it as string as lowercase = ("service pack 2"))))) OR (((name of operating system as string) starts with "Win") AND (exists (values "ProductName" of keys ("HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion") of registries as string) whose ((exists match (case insensitive regex ("^[a-za-z0-9\(\)\s-]*2008[a-za-z0-9\(\)\s]*$")) of (it as string as lowercase)))) AND (exists (values "PROCESSOR_ARCHITECTURE" of keys ("HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Environment") of registries as string) whose ((it as string as lowercase = ("x86")))) AND (exists (values "CSDVersion" of keys ("HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion") of registries as string) whose ((it as string as lowercase = ("service pack 2")))) AND not (exists (values "ProductName" of keys ("HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion") of registries as string) whose ((exists match (case insensitive regex ("^[a-za-z0-9\(\)\s-]*2008 [rr]2[a-za-z0-9\(\)\s]*$")) of (it as string as lowercase))))) OR (((name of operating system as string) starts with "Win") AND (exists (values "ProductName" of keys ("HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion") of registries as string) whose ((exists match (case insensitive regex ("^[a-za-z0-9\(\)\s-]*2008[a-za-z0-9\(\)\s]*$")) of (it as string as lowercase)))) AND (exists (values "PROCESSOR_ARCHITECTURE" of keys ("HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Environment") of registries as string) whose ((exists match (case insensitive regex ("^[aa][mm][dd]64$")) of (it as string as lowercase)))) AND (exists (values "CSDVersion" of keys ("HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion") of registries as string) whose ((it as string as lowercase = ("service pack 2"))))) OR (((name of operating system as string) starts with "Win") AND (exists (values "ProductName" of keys ("HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion") of registries as string) whose ((exists match (case insensitive regex ("^[a-za-z0-9\(\)\s-]*2008[a-za-z0-9\(\)\s]*$")) of (it as string as lowercase)))) AND (exists (values "PROCESSOR_ARCHITECTURE" of keys ("HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Environment") of registries as string) whose ((it as string as lowercase = ("ia64")))) AND (exists (values "CSDVersion" of keys ("HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion") of registries as string) whose ((it as string as lowercase = ("service pack 2")))))) AND ((exists (files "imagehlp.dll" of folders ((concatenation of ((it as string) of (values "SystemRoot" of keys ("HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion") of registries as string))) & "\System32")) whose ((version of it < (version "6.0.6002.18971")))) OR ((exists (files "imagehlp.dll" of folders ((concatenation of ((it as string) of (values "SystemRoot" of keys ("HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion") of registries as string))) & "\System32")) whose ((version of it >= (version "6.0.6002.23000")))) AND (exists (files "imagehlp.dll" of folders ((concatenation of ((it as string) of (values "SystemRoot" of keys ("HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion") of registries as string))) & "\System32")) whose ((version of it < (version "6.0.6002.23248"))))))) OR (((((name of operating system as string) starts with "Win") AND (exists (values "ProductName" of keys ("HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion") of registries as string) whose ((exists match (case insensitive regex ("^[a-za-z0-9\(\)\s]*[ww][ii][nn][dd][oo][ww][ss] 7[a-za-z0-9\(\)\s]*$")) of (it as string as lowercase)))) AND (exists (values "PROCESSOR_ARCHITECTURE" of keys ("HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Environment") of registries as string) whose ((it as string as lowercase = ("x86")))) AND (exists (values "BuildLab" of keys ("HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion") of registries as string) whose ((exists match (case insensitive regex ("^\d+\.win7sp1.*$")) of (it as string as lowercase))))) OR (((name of operating system as string) starts with "Win") AND (exists (values "ProductName" of keys ("HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion") of registries as string) whose ((exists match (case insensitive regex ("^[a-za-z0-9\(\)\s]*[ww][ii][nn][dd][oo][ww][ss] 7[a-za-z0-9\(\)\s]*$")) of (it as string as lowercase)))) AND (exists (values "PROCESSOR_ARCHITECTURE" of keys ("HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Environment") of registries as string) whose ((exists match (case insensitive regex ("^[aa][mm][dd]64$")) of (it as string as lowercase)))) AND (exists (values "BuildLab" of keys ("HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion") of registries as string) whose ((exists match (case insensitive regex ("^\d+\.win7sp1.*$")) of (it as string as lowercase))))) OR (((name of operating system as string) starts with "Win") AND (exists (values "ProductName" of keys ("HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion") of registries as string) whose ((exists match (case insensitive regex ("^[a-za-z0-9\(\)\s-]*2008 [rr]2[a-za-z0-9\(\)\s]*$")) of (it as string as lowercase)))) AND (exists (values "PROCESSOR_ARCHITECTURE" of keys ("HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Environment") of registries as string) whose ((exists match (case insensitive regex ("^[aa][mm][dd]64$")) of (it as string as lowercase)))) AND (exists (values "BuildLab" of keys ("HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion") of registries as string) whose ((exists match (case insensitive regex ("^\d+\.win7sp1.*$")) of (it as string as lowercase))))) OR (((name of operating system as string) starts with "Win") AND (exists (values "ProductName" of keys ("HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion") of registries as string) whose ((exists match (case insensitive regex ("^[a-za-z0-9\(\)\s-]*2008 [rr]2[a-za-z0-9\(\)\s]*$")) of (it as string as lowercase)))) AND (exists (values "PROCESSOR_ARCHITECTURE" of keys ("HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Environment") of registries as string) whose ((it as string as lowercase = ("ia64")))) AND (exists (values "BuildLab" of keys ("HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion") of registries as string) whose ((exists match (case insensitive regex ("^\d+\.win7sp1.*$")) of (it as string as lowercase)))))) AND ((exists (files "imagehlp.dll" of folders ((concatenation of ((it as string) of (values "SystemRoot" of keys ("HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion") of registries as string))) & "\System32")) whose ((version of it < (version "6.1.7601.18288")))) OR ((exists (files "imagehlp.dll" of folders ((concatenation of ((it as string) of (values "SystemRoot" of keys ("HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion") of registries as string))) & "\System32")) whose ((version of it >= (version "6.1.7601.22000")))) AND (exists (files "imagehlp.dll" of folders ((concatenation of ((it as string) of (values "SystemRoot" of keys ("HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion") of registries as string))) & "\System32")) whose ((version of it < (version "6.1.7601.22484"))))))) OR (((((name of operating system as string) starts with "Win") AND (exists (values "ProductName" of keys ("HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion") of registries as string) whose ((exists match (case insensitive regex ("^[a-za-z0-9\(\)\s]*[ww][ii][nn][dd][oo][ww][ss] 8[a-za-z0-9\(\)\s]*$")) of (it as string as lowercase))))) OR (((name of operating system as string) starts with "Win") AND (exists (values "ProductName" of keys ("HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion") of registries as string) whose ((exists match (case insensitive regex ("^[a-za-z0-9\(\)\s-]*2012[a-za-z0-9\(\)\s]*$")) of (it as string as lowercase)))) AND not (exists (values "ProductName" of keys ("HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion") of registries as string) whose ((exists match (case insensitive regex ("^[a-za-z0-9\(\)\s-]*2012\s[rr]2[a-za-z0-9\(\)\s]*$")) of (it as string as lowercase)))))) AND ((exists (files "imagehlp.dll" of folders ((concatenation of ((it as string) of (values "SystemRoot" of keys ("HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion") of registries as string))) & "\System32")) whose ((version of it < (version "6.2.9200.16745")))) OR ((exists (files "imagehlp.dll" of folders ((concatenation of ((it as string) of (values "SystemRoot" of keys ("HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion") of registries as string))) & "\System32")) whose ((version of it >= (version "6.2.9200.20000")))) AND (exists (files "imagehlp.dll" of folders ((concatenation of ((it as string) of (values "SystemRoot" of keys ("HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion") of registries as string))) & "\System32")) whose ((version of it < (version "6.2.9200.20856"))))))) OR (((((name of operating system as string) starts with "Win") AND (exists (values "ProductName" of keys ("HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion") of registries as string) whose ((exists match (case insensitive regex ("^[a-za-z0-9\(\)\s]*[ww][ii][nn][dd][oo][ww][ss] 8\.1[a-za-z0-9\(\)\s]*$")) of (it as string as lowercase))))) OR (((name of operating system as string) starts with "Win") AND (exists (values "ProductName" of keys ("HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion") of registries as string) whose ((exists match (case insensitive regex ("^[a-za-z0-9\(\)\s-]*2012\s[rr]2[a-za-z0-9\(\)\s]*$")) of (it as string as lowercase)))))) AND (exists (files "imagehlp.dll" of folders ((concatenation of ((it as string) of (values "SystemRoot" of keys ("HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion") of registries as string))) & "\System32")) whose ((version of it < (version "6.3.9600.16438"))))))
